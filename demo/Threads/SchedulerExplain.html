<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batch Scheduler - Detailed Explanation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 15px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.2em;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 3px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 25px;
            background: #f8f9fa;
            border: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-5px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.6;
        }

        .code-block .keyword { color: #569cd6; }
        .code-block .class-name { color: #4ec9b0; }
        .code-block .string { color: #ce9178; }
        .code-block .comment { color: #6a9955; }
        .code-block .number { color: #b5cea8; }

        .explanation {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            margin: 15px 0;
            line-height: 1.8;
        }

        .explanation h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .explanation p {
            color: #555;
            margin: 10px 0;
        }

        .flow-diagram {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .flow-step {
            display: flex;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 12px;
            color: white;
            position: relative;
        }

        .flow-step:nth-child(2) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .flow-step:nth-child(3) {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .flow-step:nth-child(4) {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .flow-step:nth-child(5) {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }

        .step-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-right: 20px;
            min-width: 60px;
            text-align: center;
        }

        .step-content h3 {
            font-size: 1.4em;
            margin-bottom: 8px;
        }

        .step-content p {
            font-size: 1em;
            opacity: 0.95;
        }

        .arrow-down {
            text-align: center;
            font-size: 2em;
            color: #667eea;
            margin: 10px 0;
        }

        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .concept-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 5px solid #667eea;
        }

        .concept-card:nth-child(2) {
            border-top-color: #51cf66;
        }

        .concept-card:nth-child(3) {
            border-top-color: #ff6b6b;
        }

        .concept-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .concept-card p {
            color: #666;
            line-height: 1.6;
        }

        .visual-demo {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .thread-pool {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .thread-box {
            flex: 1;
            min-width: 150px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
        }

        .thread-box.worker {
            background: linear-gradient(135deg, #51cf66 0%, #69db7c 100%);
        }

        .interactive-example {
            background: #fff9db;
            padding: 25px;
            border-radius: 15px;
            border: 3px solid #ffd43b;
            margin: 20px 0;
        }

        .interactive-example h4 {
            color: #f76707;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .key-point {
            background: #d3f9d8;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 5px solid #51cf66;
            margin: 15px 0;
            font-weight: bold;
            color: #2b8a3e;
        }

        .warning-box {
            background: #ffe3e3;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 5px solid #ff6b6b;
            margin: 15px 0;
            color: #c92a2a;
        }

        .timeline-visual {
            margin: 30px 0;
        }

        .timeline-row {
            display: flex;
            align-items: center;
            margin: 15px 0;
            gap: 10px;
        }

        .timeline-label {
            min-width: 150px;
            font-weight: bold;
            color: #333;
        }

        .timeline-bar-container {
            flex: 1;
            height: 40px;
            background: #e9ecef;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .timeline-segment {
            position: absolute;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.85em;
        }

        .segment-wait {
            background: #ff6b6b;
        }

        .segment-work {
            background: #51cf66;
        }

        .segment-idle {
            background: #868e96;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-size: 1.1em;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            color: #555;
        }

        tr:hover td {
            background: #f8f9fa;
        }

        .highlight {
            background: #fff3bf;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>üìö Batch Scheduler - Complete Explanation</h1>
    <p class="subtitle">Understanding Every Line of Code</p>

    <!-- Navigation Tabs -->
    <div class="nav-tabs">
        <button class="tab active" onclick="showTab('overview')">üìã Overview</button>
        <button class="tab" onclick="showTab('components')">üß© Components</button>
        <button class="tab" onclick="showTab('flow')">üîÑ Execution Flow</button>
        <button class="tab" onclick="showTab('code')">üíª Code Breakdown</button>
        <button class="tab" onclick="showTab('concepts')">üéì Key Concepts</button>
        <button class="tab" onclick="showTab('realworld')">üåç Real World</button>
    </div>

    <!-- Tab 1: Overview -->
    <div id="overview" class="tab-content active">
        <div class="section">
            <h2 class="section-title">üìã What Does This Program Do?</h2>

            <div class="explanation">
                <p style="font-size: 1.2em; line-height: 1.8;">
                    This program creates a <span class="highlight">scheduler</span> that runs <strong>automatically every 5 seconds</strong>
                    (or 2 minutes in production). Each time it runs, it creates <strong>5 worker threads</strong> that process 5 tasks
                    <strong>simultaneously</strong>. The main thread <strong>waits</strong> for all 5 workers to finish before the cycle ends.
                </p>
            </div>

            <div class="key-point">
                üí° <strong>Key Point:</strong> This is a "batch processing" pattern - process multiple items together, wait for all to complete, then repeat.
            </div>

            <h3 style="margin-top: 30px; color: #333; font-size: 1.5em;">Real-World Analogy</h3>

            <div class="interactive-example">
                <h4>üçï Pizza Restaurant Example</h4>
                <p style="color: #333; line-height: 1.8;">
                    Imagine a pizza restaurant that works in batches:<br><br>

                    <strong>‚è∞ Timer (Scheduler):</strong> Every 30 minutes, the manager says "Time for a new batch!"<br>
                    <strong>üë®‚Äçüç≥ 5 Chefs (Workers):</strong> Each chef makes one pizza<br>
                    <strong>üì¶ Batch Processor:</strong> Assigns 5 orders to the 5 chefs<br>
                    <strong>‚è≥ Waiting:</strong> Manager waits until ALL 5 pizzas are ready<br>
                    <strong>üîÑ Repeat:</strong> After 30 minutes, next batch of 5 orders begins<br><br>

                    The restaurant doesn't take new orders until the current batch is completely done!
                </p>
            </div>

            <h3 style="margin-top: 30px; color: #333; font-size: 1.5em;">Visual Timeline</h3>

            <div class="timeline-visual">
                <div class="timeline-row">
                    <div class="timeline-label">0 seconds:</div>
                    <div class="timeline-bar-container">
                        <div class="timeline-segment segment-work" style="left: 0; width: 100%;">
                            Cycle 1: 5 workers processing tasks
                        </div>
                    </div>
                </div>

                <div class="timeline-row">
                    <div class="timeline-label">5 seconds:</div>
                    <div class="timeline-bar-container">
                        <div class="timeline-segment segment-work" style="left: 0; width: 100%;">
                            Cycle 2: 5 workers processing tasks
                        </div>
                    </div>
                </div>

                <div class="timeline-row">
                    <div class="timeline-label">10 seconds:</div>
                    <div class="timeline-bar-container">
                        <div class="timeline-segment segment-work" style="left: 0; width: 100%;">
                            Cycle 3: 5 workers processing tasks
                        </div>
                    </div>
                </div>

                <div class="timeline-row">
                    <div class="timeline-label">15 seconds:</div>
                    <div class="timeline-bar-container">
                        <div class="timeline-segment segment-idle" style="left: 0; width: 100%;">
                            Program ends (after 16 seconds)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab 2: Components -->
    <div id="components" class="tab-content">
        <div class="section">
            <h2 class="section-title">üß© Three Main Components</h2>

            <div class="concept-grid">
                <div class="concept-card">
                    <h3>1Ô∏è‚É£ ScheduledExecutorService (Scheduler)</h3>
                    <p><strong>Purpose:</strong> Controls WHEN things happen</p>
                    <p><strong>Analogy:</strong> Like an alarm clock that rings every 5 seconds</p>
                    <p><strong>Configuration:</strong> 1 thread - just for scheduling</p>
                    <div class="code-block" style="margin-top: 15px;">
                        <span class="keyword">ScheduledExecutorService</span> scheduler =
                        <span class="class-name">Executors</span>.newScheduledThreadPool(<span class="number">1</span>);
                    </div>
                </div>

                <div class="concept-card">
                    <h3>2Ô∏è‚É£ ExecutorService (Worker Pool)</h3>
                    <p><strong>Purpose:</strong> Provides 5 workers to execute tasks</p>
                    <p><strong>Analogy:</strong> A team of 5 employees ready to work</p>
                    <p><strong>Configuration:</strong> Fixed pool of 5 threads</p>
                    <div class="code-block" style="margin-top: 15px;">
                        <span class="keyword">ExecutorService</span> workers =
                        <span class="class-name">Executors</span>.newFixedThreadPool(<span class="number">5</span>);
                    </div>
                </div>

                <div class="concept-card">
                    <h3>3Ô∏è‚É£ BatchProcessor (The Logic)</h3>
                    <p><strong>Purpose:</strong> Implements what to do each cycle</p>
                    <p><strong>Analogy:</strong> The manager who assigns work and waits</p>
                    <p><strong>Key Method:</strong> run() - executed every 5 seconds</p>
                    <div class="code-block" style="margin-top: 15px;">
                        <span class="keyword">class</span> <span class="class-name">BatchProcessor</span> <span class="keyword">implements</span> Runnable {
                        <span class="comment">// Logic here</span>
                        }
                    </div>
                </div>
            </div>

            <h3 style="margin-top: 40px; color: #333; font-size: 1.5em;">How They Work Together</h3>

            <div class="visual-demo">
                <div class="thread-pool">
                    <div class="thread-box">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚è∞</div>
                        <div>Scheduler Thread</div>
                        <div style="font-size: 0.85em; margin-top: 10px; opacity: 0.9;">Triggers every 5s</div>
                    </div>
                </div>

                <div style="text-align: center; font-size: 2em; color: #667eea; margin: 20px 0;">‚¨áÔ∏è</div>

                <div class="thread-pool">
                    <div class="thread-box worker">
                        <div style="font-size: 1.5em;">üë∑</div>
                        <div>Worker-1</div>
                    </div>
                    <div class="thread-box worker">
                        <div style="font-size: 1.5em;">üë∑</div>
                        <div>Worker-2</div>
                    </div>
                    <div class="thread-box worker">
                        <div style="font-size: 1.5em;">üë∑</div>
                        <div>Worker-3</div>
                    </div>
                    <div class="thread-box worker">
                        <div style="font-size: 1.5em;">üë∑</div>
                        <div>Worker-4</div>
                    </div>
                    <div class="thread-box worker">
                        <div style="font-size: 1.5em;">üë∑</div>
                        <div>Worker-5</div>
                    </div>
                </div>
            </div>

            <table style="margin-top: 30px;">
                <thead>
                <tr>
                    <th>Component</th>
                    <th>Thread Count</th>
                    <th>Responsibility</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><strong>Scheduler</strong></td>
                    <td>1 thread</td>
                    <td>Calls BatchProcessor.run() every 5 seconds</td>
                </tr>
                <tr>
                    <td><strong>Worker Pool</strong></td>
                    <td>5 threads</td>
                    <td>Executes the actual tasks (doWork method)</td>
                </tr>
                <tr>
                    <td><strong>Main Thread</strong></td>
                    <td>1 thread</td>
                    <td>Sets up everything, then sleeps for 16 seconds</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Tab 3: Execution Flow -->
    <div id="flow" class="tab-content">
        <div class="section">
            <h2 class="section-title">üîÑ Step-by-Step Execution Flow</h2>

            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Program Starts</h3>
                        <p>Main thread creates scheduler (1 thread) and worker pool (5 threads)</p>
                    </div>
                </div>

                <div class="arrow-down">‚¨áÔ∏è</div>

                <div class="flow-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Schedule the BatchProcessor</h3>
                        <p>Tell scheduler: "Run BatchProcessor every 5 seconds, starting immediately"</p>
                    </div>
                </div>

                <div class="arrow-down">‚¨áÔ∏è</div>

                <div class="flow-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Cycle Begins (run() method called)</h3>
                        <p>BatchProcessor creates 5 tasks and submits them to worker pool</p>
                    </div>
                </div>

                <div class="arrow-down">‚¨áÔ∏è</div>

                <div class="flow-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>Workers Execute Tasks Simultaneously</h3>
                        <p>All 5 workers run in parallel. Each takes 1-3 seconds (random)</p>
                    </div>
                </div>

                <div class="arrow-down">‚¨áÔ∏è</div>

                <div class="flow-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3>Wait for All to Complete (.get() blocks)</h3>
                        <p>BatchProcessor calls .get() on each Future - waits until all 5 finish</p>
                    </div>
                </div>

                <div class="arrow-down">‚¨áÔ∏è</div>

                <div class="flow-step">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h3>Cycle Complete - Wait 5 Seconds</h3>
                        <p>Scheduler automatically waits 5 seconds, then triggers next cycle</p>
                    </div>
                </div>

                <div class="arrow-down">‚¨áÔ∏è</div>

                <div class="flow-step">
                    <div class="step-number">7</div>
                    <div class="step-content">
                        <h3>Repeat Steps 3-6</h3>
                        <p>Continues until main thread shuts everything down after 16 seconds</p>
                    </div>
                </div>
            </div>

            <div class="key-point" style="margin-top: 30px;">
                ‚ö° <strong>Important:</strong> The scheduler doesn't care how long each cycle takes. It just waits 5 seconds from when the previous cycle STARTED.
            </div>

            <div class="warning-box">
                ‚ö†Ô∏è <strong>Note:</strong> If a cycle takes longer than 5 seconds, the next cycle starts immediately after completion (no overlap).
            </div>
        </div>
    </div>

    <!-- Tab 4: Code Breakdown -->
    <div id="code" class="tab-content">
        <div class="section">
            <h2 class="section-title">üíª Line-by-Line Code Explanation</h2>

            <h3 style="color: #333; margin: 30px 0 20px 0; font-size: 1.4em;">Main Method</h3>

            <div class="code-block">
                <span class="keyword">public static void</span> main(<span class="class-name">String</span>[] args) <span class="keyword">throws</span> <span class="class-name">InterruptedException</span> {
                <span class="class-name">System</span>.out.println(<span class="string">"=== Simple Batch Scheduler ==="</span>);
            </div>

            <div class="explanation">
                <h4>Line 1-2: Start the program</h4>
                <p>Print a header message to console.</p>
            </div>

            <div class="code-block">
                <span class="comment">// Create scheduler - runs tasks on schedule</span>
                <span class="class-name">ScheduledExecutorService</span> scheduler = <span class="class-name">Executors</span>.newScheduledThreadPool(<span class="number">1</span>);
            </div>

            <div class="explanation">
                <h4>Line 3-4: Create Scheduler</h4>
                <p><strong>What it does:</strong> Creates a thread pool with 1 thread dedicated to scheduling.</p>
                <p><strong>Why 1 thread?</strong> We only need one "timer" thread to trigger events.</p>
                <p><strong>Real analogy:</strong> Hiring one person whose only job is to watch the clock and say "Time to start!" every 5 seconds.</p>
            </div>

            <div class="code-block">
                <span class="comment">// Create worker pool - 5 workers to do the tasks</span>
                <span class="class-name">ExecutorService</span> workers = <span class="class-name">Executors</span>.newFixedThreadPool(<span class="number">5</span>);
            </div>

            <div class="explanation">
                <h4>Line 5-6: Create Worker Pool</h4>
                <p><strong>What it does:</strong> Creates exactly 5 worker threads that will execute tasks.</p>
                <p><strong>Why 5?</strong> Because we want to process 5 tasks simultaneously each cycle.</p>
                <p><strong>Fixed pool:</strong> These 5 threads are reused for every cycle - no new threads created.</p>
            </div>

            <div class="code-block">
                <span class="comment">// Create batch processor</span>
                <span class="class-name">BatchProcessor</span> processor = <span class="keyword">new</span> <span class="class-name">BatchProcessor</span>(workers);
            </div>

            <div class="explanation">
                <h4>Line 7-8: Create BatchProcessor Instance</h4>
                <p><strong>What it does:</strong> Creates our custom BatchProcessor object and gives it access to the worker pool.</p>
                <p><strong>Why pass workers?</strong> So BatchProcessor can submit tasks to those 5 workers.</p>
            </div>

            <div class="code-block">
                <span class="comment">// Run every 5 seconds (change to 120 for 2 minutes)</span>
                scheduler.scheduleAtFixedRate(processor, <span class="number">0</span>, <span class="number">5</span>, <span class="class-name">TimeUnit</span>.SECONDS);
            </div>

            <div class="explanation">
                <h4>Line 9-10: Schedule Repeating Execution</h4>
                <p><strong>scheduleAtFixedRate:</strong> Method that runs something repeatedly</p>
                <p><strong>processor:</strong> What to run (calls processor.run())</p>
                <p><strong>0:</strong> Initial delay - start immediately</p>
                <p><strong>5:</strong> Period - wait 5 seconds between runs</p>
                <p><strong>TimeUnit.SECONDS:</strong> The time unit for the numbers above</p>
                <p><strong>In production:</strong> Change 5 to 120 and SECONDS to MINUTES for 2-minute intervals</p>
            </div>

            <div class="code-block">
                <span class="comment">// Run for 15 seconds (3 cycles)</span>
                <span class="class-name">Thread</span>.sleep(<span class="number">16000</span>);
            </div>

            <div class="explanation">
                <h4>Line 11-12: Let It Run</h4>
                <p><strong>What it does:</strong> Main thread sleeps for 16 seconds while scheduler runs in background.</p>
                <p><strong>Why 16 seconds?</strong> Gives time for 3 complete cycles (0s, 5s, 10s) plus a little extra.</p>
                <p><strong>In production:</strong> This would run forever or until interrupted.</p>
            </div>

            <div class="code-block">
                <span class="comment">// Stop everything</span>
                scheduler.shutdown();
                workers.shutdown();
                <span class="class-name">System</span>.out.println(<span class="string">"Done!"</span>);
                }
            </div>

            <div class="explanation">
                <h4>Line 13-16: Clean Shutdown</h4>
                <p><strong>scheduler.shutdown():</strong> Stop scheduling new cycles</p>
                <p><strong>workers.shutdown():</strong> Stop accepting new tasks (existing tasks complete)</p>
                <p><strong>Important:</strong> Always shutdown executors to prevent resource leaks!</p>
            </div>

            <h3 style="color: #333; margin: 40px 0 20px 0; font-size: 1.4em;">BatchProcessor Class</h3>

            <div class="code-block">
                <span class="keyword">class</span> <span class="class-name">BatchProcessor</span> <span class="keyword">implements</span> <span class="class-name">Runnable</span> {

                <span class="keyword">private</span> <span class="class-name">ExecutorService</span> workers;
                <span class="keyword">private int</span> cycleNumber = <span class="number">0</span>;
                <span class="keyword">private int</span> taskId = <span class="number">1</span>;
            </div>

            <div class="explanation">
                <h4>Class Declaration and Fields</h4>
                <p><strong>implements Runnable:</strong> Required to be scheduled (must have run() method)</p>
                <p><strong>workers:</strong> Reference to the 5-thread worker pool</p>
                <p><strong>cycleNumber:</strong> Tracks which cycle we're on (1, 2, 3...)</p>
                <p><strong>taskId:</strong> Unique ID for each task (increments: 1, 2, 3, 4, 5, 6...)</p>
            </div>

            <div class="code-block">
                <span class="keyword">public</span> BatchProcessor(<span class="class-name">ExecutorService</span> workers) {
                <span class="keyword">this</span>.workers = workers;
                }
            </div>

            <div class="explanation">
                <h4>Constructor</h4>
                <p>Receives the worker pool from main method and stores it.</p>
            </div>

            <div class="code-block">
                <span class="keyword">@Override</span>
                <span class="keyword">public void</span> run() {
                cycleNumber++;
                <span class="class-name">System</span>.out.println(<span class="string">"\n--- Cycle "</span> + cycleNumber + <span class="string">" ---"</span>);
            </div>

            <div class="explanation">
                <h4>run() Method - Called Every 5 Seconds</h4>
                <p><strong>Scheduler calls this automatically:</strong> You never call run() directly</p>
                <p><strong>cycleNumber++:</strong> Increment cycle count (1, 2, 3...)</p>
                <p><strong>Print message:</strong> Shows which cycle is starting</p>
            </div>

            <div class="code-block">
                <span class="comment">// Create 5 tasks</span>
                <span class="class-name">Future</span>&lt;?&gt; task1 = workers.submit(() -&gt; doWork(taskId++, <span class="number">1</span>));
                <span class="class-name">Future</span>&lt;?&gt; task2 = workers.submit(() -&gt; doWork(taskId++, <span class="number">2</span>));
                <span class="class-name">Future</span>&lt;?&gt; task3 = workers.submit(() -&gt; doWork(taskId++, <span class="number">3</span>));
                <span class="class-name">Future</span>&lt;?&gt; task4 = workers.submit(() -&gt; doWork(taskId++, <span class="number">4</span>));
                <span class="class-name">Future</span>&lt;?&gt; task5 = workers.submit(() -&gt; doWork(taskId++, <span class="number">5</span>));
            </div>

            <div class="explanation">
                <h4>Submit 5 Tasks to Worker Pool</h4>
                <p><strong>workers.submit():</strong> Sends task to worker pool for execution</p>
                <p><strong>Lambda () -> doWork():</strong> The actual work to perform</p>
                <p><strong>taskId++:</strong> Use current taskId, then increment (post-increment)</p>
                <p><strong>Worker number (1-5):</strong> Just for logging which worker is doing what</p>
                <p><strong>Future<?>:</strong> A "receipt" that lets us check if task is done and get result</p>
                <p><strong>All 5 start immediately:</strong> They run in parallel, not one after another</p>
            </div>

            <div class="code-block">
                <span class="comment">// Wait for all 5 to finish</span>
                <span class="keyword">try</span> {
                task1.get();
                task2.get();
                task3.get();
                task4.get();
                task5.get();
                } <span class="keyword">catch</span> (<span class="class-name">Exception</span> e) {
                e.printStackTrace();
                }
            </div>

            <div class="explanation">
                <h4>Wait for All Tasks to Complete</h4>
                <p><strong>.get():</strong> BLOCKS until that task finishes</p>
                <p><strong>Why call all 5?:</strong> Must wait for every task before cycle ends</p>
                <p><strong>Order matters?:</strong> No - .get() waits for that specific task regardless of order</p>
                <p><strong>Example:</strong> If task3 finishes first, task3.get() returns immediately. But task1.get() waits until task1 finishes.</p>
                <p><strong>Result:</strong> This section doesn't complete until ALL 5 workers are done</p>
            </div>

            <div class="code-block">
                <span class="class-name">System</span>.out.println(<span class="string">"All 5 tasks done!\n"</span>);
                }
            </div>

            <div class="explanation">
                <h4>Cycle Complete</h4>
                <p>Print message indicating all 5 tasks finished. Then run() method ends and scheduler waits 5 seconds before calling run() again.</p>
            </div>

            <div class="code-block">
                <span class="keyword">private void</span> doWork(<span class="keyword">int</span> taskId, <span class="keyword">int</span> workerNum) {
                <span class="class-name">System</span>.out.println(<span class="string">"Worker-"</span> + workerNum + <span class="string">" doing Task-"</span> + taskId);

                <span class="comment">// Simulate work (1-3 seconds)</span>
                <span class="keyword">try</span> {
                <span class="class-name">Thread</span>.sleep(<span class="number">1000</span> + (<span class="keyword">int</span>)(<span class="class-name">Math</span>.random() * <span class="number">2000</span>));
                } <span class="keyword">catch</span> (<span class="class-name">InterruptedException</span> e) {
                e.printStackTrace();
                }

                <span class="class-name">System</span>.out.println(<span class="string">"Worker-"</span> + workerNum + <span class="string">" finished Task-"</span> + taskId);
                }
                }
            </div>

            <div class="explanation">
                <h4>doWork() - The Actual Task</h4>
                <p><strong>This is what each worker does:</strong></p>
                <p>1. Print "starting" message</p>
                <p>2. Sleep 1-3 seconds (simulates real work like database query, API call, etc.)</p>
                <p>3. Print "finished" message</p>
                <p><strong>Random time:</strong> Makes it realistic - some tasks finish faster than others</p>
                <p><strong>In real app:</strong> Replace Thread.sleep() with actual work (file processing, API calls, calculations, etc.)</p>
            </div>
        </div>
    </div>

    <!-- Tab 5: Key Concepts -->
    <div id="concepts" class="tab-content">
        <div class="section">
            <h2 class="section-title">üéì Important Concepts to Understand</h2>

            <h3 style="color: #333; margin: 30px 0 20px 0; font-size: 1.4em;">1. What is scheduleAtFixedRate?</h3>

            <div class="explanation">
                <p><strong>Purpose:</strong> Run something repeatedly at fixed time intervals</p>

                <div class="code-block" style="margin: 15px 0;">
                    scheduler.scheduleAtFixedRate(task, initialDelay, period, timeUnit);
                </div>

                <p><strong>Parameters:</strong></p>
                <ul style="margin: 15px 0; padding-left: 40px; line-height: 2;">
                    <li><strong>task:</strong> What to run (must be Runnable)</li>
                    <li><strong>initialDelay:</strong> How long to wait before first run (0 = start immediately)</li>
                    <li><strong>period:</strong> Time between each run</li>
                    <li><strong>timeUnit:</strong> Units for the numbers (SECONDS, MINUTES, HOURS, etc.)</li>
                </ul>
            </div>

            <div class="interactive-example">
                <h4>üî¢ Different Schedule Examples</h4>
                <div class="code-block">
                    <span class="comment">// Run every 5 seconds, start immediately</span>
                    scheduler.scheduleAtFixedRate(task, <span class="number">0</span>, <span class="number">5</span>, <span class="class-name">TimeUnit</span>.SECONDS);

                    <span class="comment">// Run every 2 minutes, start immediately</span>
                    scheduler.scheduleAtFixedRate(task, <span class="number">0</span>, <span class="number">2</span>, <span class="class-name">TimeUnit</span>.MINUTES);

                    <span class="comment">// Run every hour, wait 10 minutes before first run</span>
                    scheduler.scheduleAtFixedRate(task, <span class="number">10</span>, <span class="number">60</span>, <span class="class-name">TimeUnit</span>.MINUTES);

                    <span class="comment">// Run every day at same time</span>
                    scheduler.scheduleAtFixedRate(task, <span class="number">0</span>, <span class="number">24</span>, <span class="class-name">TimeUnit</span>.HOURS);
                </div>
            </div>

            <h3 style="color: #333; margin: 40px 0 20px 0; font-size: 1.4em;">2. Fixed Rate vs Fixed Delay</h3>

            <table>
                <thead>
                <tr>
                    <th>Method</th>
                    <th>Timing</th>
                    <th>Best For</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><strong>scheduleAtFixedRate</strong></td>
                    <td>Runs every X seconds from START of previous run</td>
                    <td>Tasks that should happen at exact intervals (our case)</td>
                </tr>
                <tr>
                    <td><strong>scheduleWithFixedDelay</strong></td>
                    <td>Waits X seconds after COMPLETION of previous run</td>
                    <td>Tasks where you want guaranteed rest time between runs</td>
                </tr>
                </tbody>
            </table>

            <div class="visual-demo" style="margin-top: 20px;">
                <h4 style="color: #333; margin-bottom: 15px;">Visual Comparison</h4>

                <p style="font-weight: bold; color: #667eea; margin: 20px 0 10px 0;">scheduleAtFixedRate (What we use):</p>
                <div class="timeline-row">
                    <div class="timeline-label">Time:</div>
                    <div class="timeline-bar-container">
                        <div class="timeline-segment segment-work" style="left: 0; width: 20%;">Run 1</div>
                        <div class="timeline-segment segment-work" style="left: 20%; width: 20%;">Run 2</div>
                        <div class="timeline-segment segment-work" style="left: 40%; width: 20%;">Run 3</div>
                    </div>
                </div>
                <p style="color: #666; font-size: 0.9em; margin-top: 5px;">‚Üë Starts every 5 seconds regardless of how long previous run took</p>

                <p style="font-weight: bold; color: #51cf66; margin: 30px 0 10px 0;">scheduleWithFixedDelay (Alternative):</p>
                <div class="timeline-row">
                    <div class="timeline-label">Time:</div>
                    <div class="timeline-bar-container">
                        <div class="timeline-segment segment-work" style="left: 0; width: 15%;">Run 1</div>
                        <div class="timeline-segment segment-idle" style="left: 15%; width: 5%;"></div>
                        <div class="timeline-segment segment-work" style="left: 20%; width: 15%;">Run 2</div>
                        <div class="timeline-segment segment-idle" style="left: 35%; width: 5%;"></div>
                        <div class="timeline-segment segment-work" style="left: 40%; width: 15%;">Run 3</div>
                    </div>
                </div>
                <p style="color: #666; font-size: 0.9em; margin-top: 5px;">‚Üë Waits 5 seconds AFTER previous run completes</p>
            </div>

            <h3 style="color: #333; margin: 40px 0 20px 0; font-size: 1.4em;">3. Why Use Future.get()?</h3>

            <div class="explanation">
                <h4>What is Future?</h4>
                <p>A Future is like a "promise" or "receipt" for a task that's running in the background.</p>

                <h4 style="margin-top: 20px;">What does .get() do?</h4>
                <p><strong>Blocks the current thread</strong> until the task completes, then returns the result.</p>

                <div class="code-block" style="margin: 15px 0;">
                    <span class="class-name">Future</span>&lt;?&gt; task1 = workers.submit(() -&gt; doWork(<span class="number">1</span>, <span class="number">1</span>));
                    <span class="comment">// Task is now running in background...</span>

                    task1.get();  <span class="comment">// ‚è∏Ô∏è WAIT HERE until task1 finishes</span>
                    <span class="comment">// Now task1 is complete, continue...</span>
                </div>
            </div>

            <div class="key-point">
                üí° <strong>Key Point:</strong> Calling .get() on all 5 Futures ensures we wait for ALL workers before the cycle ends.
            </div>

            <h3 style="color: #333; margin: 40px 0 20px 0; font-size: 1.4em;">4. Thread Pool Reuse</h3>

            <div class="explanation">
                <p><strong>Important:</strong> The 5 worker threads are NOT created fresh each cycle!</p>

                <p style="margin: 15px 0;"><strong>How it works:</strong></p>
                <ul style="margin: 15px 0; padding-left: 40px; line-height: 2;">
                    <li><strong>Cycle 1:</strong> Creates 5 threads, they do tasks 1-5</li>
                    <li><strong>Cycle 2:</strong> SAME 5 threads do tasks 6-10</li>
                    <li><strong>Cycle 3:</strong> SAME 5 threads do tasks 11-15</li>
                    <li>And so on...</li>
                </ul>

                <p><strong>Why?</strong> Creating threads is expensive. Reusing them is much more efficient!</p>
            </div>

            <h3 style="color: #333; margin: 40px 0 20px 0; font-size: 1.4em;">5. Shutdown Best Practice</h3>

            <div class="explanation">
                <p>Always shutdown executors when done:</p>

                <div class="code-block" style="margin: 15px 0;">
                    scheduler.shutdown();  <span class="comment">// Stop scheduling new cycles</span>
                    workers.shutdown();    <span class="comment">// Stop accepting new tasks</span>
                </div>

                <p><strong>What happens if you don't?</strong></p>
                <ul style="margin: 15px 0; padding-left: 40px; line-height: 2;">
                    <li>Threads keep running forever</li>
                    <li>Program never exits (hangs)</li>
                    <li>Memory leak</li>
                </ul>
            </div>

            <div class="warning-box">
                ‚ö†Ô∏è <strong>Note:</strong> shutdown() doesn't kill running tasks. It just prevents new ones. Use shutdownNow() to forcefully stop everything.
            </div>
        </div>
    </div>

    <!-- Tab 6: Real World -->
    <div id="realworld" class="tab-content">
        <div class="section">
            <h2 class="section-title">üåç Real-World Use Cases</h2>

            <div class="concept-grid">
                <div class="concept-card">
                    <h3>üìß Email Batch Processor</h3>
                    <p><strong>Scenario:</strong> Send promotional emails every 2 hours</p>
                    <p><strong>How:</strong> Every 2 hours, fetch 5 email batches, send each batch in parallel, wait for all to complete</p>
                    <p><strong>Why this pattern:</strong> Ensures one batch finishes before starting next, prevents overload</p>
                </div>

                <div class="concept-card">
                    <h3>üìä Report Generation</h3>
                    <p><strong>Scenario:</strong> Generate 5 different reports every night at midnight</p>
                    <p><strong>How:</strong> Sales report, inventory report, customer report, financial report, analytics report - all generated in parallel</p>
                    <p><strong>Why this pattern:</strong> Complete all reports before sending summary email</p>
                </div>

                <div class="concept-card">
                    <h3>üîÑ Data Sync</h3>
                    <p><strong>Scenario:</strong> Sync data from 5 external APIs every 10 minutes</p>
                    <p><strong>How:</strong> Call all 5 APIs simultaneously, wait for all responses, then process batch together</p>
                    <p><strong>Why this pattern:</strong> Maintain data consistency across all sources</p>
                </div>

                <div class="concept-card">
                    <h3>üñºÔ∏è Image Processing</h3>
                    <p><strong>Scenario:</strong> Process user-uploaded images in batches</p>
                    <p><strong>How:</strong> Every 30 seconds, pick 5 images, resize/compress in parallel, save all before next batch</p>
                    <p><strong>Why this pattern:</strong> Prevents queue backlog, ensures orderly processing</p>
                </div>

                <div class="concept-card">
                    <h3>üóÑÔ∏è Database Cleanup</h3>
                    <p><strong>Scenario:</strong> Clean up old records every 6 hours</p>
                    <p><strong>How:</strong> Delete from 5 different tables simultaneously, wait for all deletions to commit</p>
                    <p><strong>Why this pattern:</strong> Atomic cleanup - either all tables cleaned or none</p>
                </div>

                <div class="concept-card">
                    <h3>üì± Push Notifications</h3>
                    <p><strong>Scenario:</strong> Send notifications to user segments every 15 minutes</p>
                    <p><strong>How:</strong> 5 segments (VIP, active, inactive, new, returning), send to each in parallel</p>
                    <p><strong>Why this pattern:</strong> Complete one campaign before starting next</p>
                </div>
            </div>

            <h3 style="color: #333; margin: 40px 0 20px 0; font-size: 1.4em;">Code Template for Your Use Case</h3>

            <div class="code-block">
                <span class="keyword">import</span> java.util.concurrent.*;

                <span class="keyword">public class</span> <span class="class-name">YourBatchProcessor</span> {

                <span class="keyword">public static void</span> main(<span class="class-name">String</span>[] args) <span class="keyword">throws</span> <span class="class-name">InterruptedException</span> {
                <span class="comment">// 1. Create scheduler (1 thread for timing)</span>
                <span class="class-name">ScheduledExecutorService</span> scheduler =
                <span class="class-name">Executors</span>.newScheduledThreadPool(<span class="number">1</span>);

                <span class="comment">// 2. Create worker pool (N workers for parallel execution)</span>
                <span class="class-name">ExecutorService</span> workers =
                <span class="class-name">Executors</span>.newFixedThreadPool(<span class="number">5</span>); <span class="comment">// Change 5 to your needs</span>

                <span class="comment">// 3. Create your batch processor</span>
                <span class="class-name">YourProcessor</span> processor = <span class="keyword">new</span> <span class="class-name">YourProcessor</span>(workers);

                <span class="comment">// 4. Schedule it</span>
                scheduler.scheduleAtFixedRate(
                processor,
                <span class="number">0</span>,              <span class="comment">// Start immediately</span>
                <span class="number">120</span>,            <span class="comment">// Every 2 minutes (change as needed)</span>
                <span class="class-name">TimeUnit</span>.SECONDS
                );

                <span class="comment">// 5. Let it run (or run forever)</span>
                <span class="comment">// Thread.sleep(Long.MAX_VALUE); // Run forever</span>

                <span class="comment">// 6. Cleanup when done</span>
                <span class="comment">// scheduler.shutdown();</span>
                <span class="comment">// workers.shutdown();</span>
                }
                }

                <span class="keyword">class</span> <span class="class-name">YourProcessor</span> <span class="keyword">implements</span> <span class="class-name">Runnable</span> {
                <span class="keyword">private</span> <span class="class-name">ExecutorService</span> workers;

                <span class="keyword">public</span> YourProcessor(<span class="class-name">ExecutorService</span> workers) {
                <span class="keyword">this</span>.workers = workers;
                }

                <span class="keyword">@Override</span>
                <span class="keyword">public void</span> run() {
                <span class="comment">// This runs every 2 minutes</span>

                <span class="comment">// Submit your tasks</span>
                <span class="class-name">Future</span>&lt;?&gt; task1 = workers.submit(() -&gt; yourTask(<span class="number">1</span>));
                <span class="class-name">Future</span>&lt;?&gt; task2 = workers.submit(() -&gt; yourTask(<span class="number">2</span>));
                <span class="class-name">Future</span>&lt;?&gt; task3 = workers.submit(() -&gt; yourTask(<span class="number">3</span>));
                <span class="class-name">Future</span>&lt;?&gt; task4 = workers.submit(() -&gt; yourTask(<span class="number">4</span>));
                <span class="class-name">Future</span>&lt;?&gt; task5 = workers.submit(() -&gt; yourTask(<span class="number">5</span>));

                <span class="comment">// Wait for all</span>
                <span class="keyword">try</span> {
                task1.get(); task2.get(); task3.get(); task4.get(); task5.get();
                } <span class="keyword">catch</span> (<span class="class-name">Exception</span> e) {
                e.printStackTrace();
                }
                }

                <span class="keyword">private void</span> yourTask(<span class="keyword">int</span> taskNum) {
                <span class="comment">// Replace with your actual work:</span>
                <span class="comment">// - API call</span>
                <span class="comment">// - Database query</span>
                <span class="comment">// - File processing</span>
                <span class="comment">// - Email sending</span>
                <span class="comment">// - Report generation</span>
                <span class="comment">// etc.</span>
                }
                }
            </div>

            <div class="key-point" style="margin-top: 30px;">
                ‚ú® <strong>Pro Tip:</strong> Adjust the worker pool size based on your needs. CPU-intensive tasks: use Runtime.getRuntime().availableProcessors(). I/O-intensive tasks: can use more threads (10-20+).
            </div>

            <h3 style="color: #333; margin: 40px 0 20px 0; font-size: 1.4em;">When NOT to Use This Pattern</h3>

            <div class="warning-box">
                <p><strong>Don't use this pattern if:</strong></p>
                <ul style="margin: 15px 0; padding-left: 40px; line-height: 2;">
                    <li>Tasks are independent and don't need batch coordination</li>
                    <li>You need results immediately (use CompletableFuture instead)</li>
                    <li>Tasks have different schedules (use separate schedulers)</li>
                    <li>You need complex task dependencies (use workflow engine)</li>
                </ul>
            </div>

            <div class="key-point">
                ‚úÖ <strong>Use this pattern when:</strong> You need to process multiple items together, wait for all to complete, and repeat at regular intervals.
            </div>
        </div>
    </div>
</div>

<script>
    function showTab(tabName) {
        // Hide all tab contents
        const contents = document.querySelectorAll('.tab-content');
        contents.forEach(content => content.classList.remove('active'));

        // Remove active class from all tabs
        const tabs = document.querySelectorAll('.tab');
        tabs.forEach(tab => tab.classList.remove('active'));

        // Show selected tab content
        document.getElementById(tabName).classList.add('active');

        // Add active class to clicked tab
        event.target.classList.add('active');
    }
</script>
</body>
</html>
